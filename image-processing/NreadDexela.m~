function img = NreadDexela(pfname, frameno)
% NreadDexela - read Dexela file from fastsweep image stack saved in ncdf
% format (nc extension).
%
%   INPUT:
%
%   filename
%       name of the GE image stack file name
%
%   frameno
%       frame to load
%
%   OUTPUT:
%
%   img
%       image data in a [2048 x 2048] matrix
%
%   NOTE:
%   1. if the image size changes, this file needs to be updated.
%   2. if the buffer contains useful information, this file needs to read
%   it in.

finfo       = ncinfo(pfname);
nframe      = finfo.Dimensions(1).Length;
numpixHorz  = finfo.Dimensions(2).Length;
numpixVert  = finfo.Dimensions(3).Length;

if frameno > nframe
    error(sprintf('frame number %d requested is larger than number of frames % stored in the file %s', frameno, nframe, pfname); 
end

istart  = [1 1 iframe]';
iend    = [numpixVert numpixHorz 1]';


fp      = fopen(pfname,'r','n');
offset  = buffer + (frameno-1)*2048*2048*2;

fseek(fp,offset,'bof');

img     = fread(fp,[2048 2048],'*uint16');

fclose(fp);
